{% extends "base.html" %}
{% load static %}

{% block title %}Login | MockMate{% endblock %}

{% block content %}
<section class="min-h-screen bg-gradient-to-br from-purple-400 via-pink-500 to-red-500 relative overflow-hidden">
  <!-- Enhanced Animated Background Elements -->
  <div class="absolute inset-0 overflow-hidden">
    <div class="floating-element absolute top-20 left-10 w-20 h-20 bg-white/20 rounded-full blur-xl"></div>
    <div class="floating-element absolute top-40 right-20 w-32 h-32 bg-yellow-300/30 rounded-full blur-2xl animation-delay-1000"></div>
    <div class="floating-element absolute bottom-32 left-20 w-24 h-24 bg-blue-400/25 rounded-full blur-xl animation-delay-2000"></div>
    <div class="floating-element absolute bottom-20 right-32 w-16 h-16 bg-green-300/30 rounded-full blur-lg animation-delay-3000"></div>
    <div class="floating-element absolute top-1/2 left-1/4 w-12 h-12 bg-indigo-300/20 rounded-full blur-md animation-delay-4000"></div>
    <div class="floating-element absolute top-1/3 right-1/3 w-28 h-28 bg-rose-300/15 rounded-full blur-2xl animation-delay-5000"></div>
  </div>

  <div class="relative z-10 min-h-screen flex items-center justify-center p-4">
    <div class="max-w-md w-full">
      <!-- Login Card -->
      <div class="bg-white/95 backdrop-blur-lg rounded-3xl shadow-2xl p-8 border border-white/20 transform hover:scale-105 transition-all duration-300 animate-fade-in-up">
        <!-- Header with animated icon -->
        <div class="text-center mb-8">
          <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full mb-6 shadow-lg animate-bounce-slow">
            <i class="ri-user-smile-line text-3xl text-white"></i>
          </div>
          <h1 class="text-4xl font-black bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 bg-clip-text text-transparent mb-2 animate-gradient">
            Welcome Back! 
          </h1>
          <div class="flex items-center justify-center gap-2 mb-4">
            <span class="text-2xl animate-wave">ðŸ‘‹</span>
            <span class="text-2xl animate-pulse-slow">ðŸš€</span>
          </div>
          <p class="text-gray-600 font-medium">Ready to ace your next mock interview?</p>
        </div>

        {# Flash messages block with enhanced styling #}
        {% if messages %}
          <div class="mb-6 space-y-3">
            {% for message in messages %}
              <div class="text-sm px-4 py-3 rounded-2xl border-l-4 transform animate-slide-in
                {% if message.tags == 'success' %}bg-green-50 text-green-800 border-green-400 shadow-green-100
                {% elif message.tags == 'error' %}bg-red-50 text-red-800 border-red-400 shadow-red-100
                {% elif message.tags == 'warning' %}bg-yellow-50 text-yellow-800 border-yellow-400 shadow-yellow-100
                {% else %}bg-blue-50 text-blue-800 border-blue-400 shadow-blue-100{% endif %} shadow-lg">
                <div class="flex items-center gap-2">
                  {% if message.tags == 'success' %}<i class="ri-check-circle-line text-lg animate-bounce"></i>
                  {% elif message.tags == 'error' %}<i class="ri-error-warning-line text-lg animate-pulse"></i>
                  {% elif message.tags == 'warning' %}<i class="ri-alert-line text-lg animate-pulse"></i>
                  {% else %}<i class="ri-information-line text-lg"></i>{% endif %}
                  <span class="font-medium">{{ message }}</span>
                </div>
              </div>
            {% endfor %}
          </div>
        {% endif %}

        <form method="POST" action="{% url 'login' %}" class="space-y-6" novalidate>
          {% csrf_token %}

          {% if form.non_field_errors %}
            <div class="bg-red-50 border border-red-200 rounded-2xl p-4 animate-shake">
              <div class="flex items-center gap-2 text-red-800">
                <i class="ri-error-warning-line text-lg animate-pulse"></i>
                <div class="text-sm font-medium">
                  {% for error in form.non_field_errors %}
                    <p>{{ error }}</p>
                  {% endfor %}
                </div>
              </div>
            </div>
          {% endif %}

          <!-- Username Field -->
          <div class="form-group">
            <label for="{{ form.username.id_for_label }}" class="block text-sm font-bold text-gray-700 mb-2 flex items-center gap-2">
              <i class="ri-user-line text-purple-500"></i>
              Username
            </label>
            <div class="relative group">
              <input 
                type="text" 
                name="{{ form.username.name }}" 
                id="{{ form.username.id_for_label }}"
                value="{{ form.username.value|default:'' }}"
                placeholder="Enter your username"
                autofocus
                class="w-full px-4 py-4 pl-12 border-2 border-gray-200 rounded-2xl focus:outline-none focus:ring-4 focus:ring-purple-200 focus:border-purple-500 transition-all duration-300 bg-gray-50 hover:bg-white text-lg font-medium group-hover:border-purple-300 {% if form.username.errors %}border-red-300 focus:border-red-500 focus:ring-red-200{% endif %}"
                {% if form.username.field.required %}required{% endif %}
              >
              <i class="ri-user-line absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 text-lg group-focus-within:text-purple-500 transition-colors duration-300"></i>
              <div class="absolute inset-0 rounded-2xl bg-gradient-to-r from-purple-500/10 to-pink-500/10 opacity-0 group-focus-within:opacity-100 transition-opacity duration-300 pointer-events-none"></div>
            </div>
            {% if form.username.errors %}
              <div class="mt-2 animate-fade-in">
                {% for error in form.username.errors %}
                  <div class="flex items-center gap-2 text-red-600">
                    <i class="ri-error-warning-line text-sm"></i>
                    <p class="text-sm font-medium">{{ error }}</p>
                  </div>
                {% endfor %}
              </div>
            {% endif %}
          </div>

          <!-- Password Field -->
          <div class="form-group">
            <label for="{{ form.password.id_for_label }}" class="block text-sm font-bold text-gray-700 mb-2 flex items-center gap-2">
              <i class="ri-lock-line text-purple-500"></i>
              Password
            </label>
            <div class="relative group">
              <input 
                type="password" 
                name="{{ form.password.name }}" 
                id="{{ form.password.id_for_label }}"
                placeholder="Enter your password"
                class="w-full px-4 py-4 pl-12 pr-12 border-2 border-gray-200 rounded-2xl focus:outline-none focus:ring-4 focus:ring-purple-200 focus:border-purple-500 transition-all duration-300 bg-gray-50 hover:bg-white text-lg font-medium group-hover:border-purple-300 {% if form.password.errors %}border-red-300 focus:border-red-500 focus:ring-red-200{% endif %}"
                {% if form.password.field.required %}required{% endif %}
              >
              <i class="ri-lock-line absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 text-lg group-focus-within:text-purple-500 transition-colors duration-300"></i>
              <!-- Password Toggle Button -->
              <button type="button" class="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-purple-500 transition-colors duration-300 focus:outline-none" onclick="togglePassword('{{ form.password.id_for_label }}')">
                <i class="ri-eye-line text-lg" id="password-toggle-icon"></i>
              </button>
              <div class="absolute inset-0 rounded-2xl bg-gradient-to-r from-purple-500/10 to-pink-500/10 opacity-0 group-focus-within:opacity-100 transition-opacity duration-300 pointer-events-none"></div>
            </div>
            {% if form.password.errors %}
              <div class="mt-2 animate-fade-in">
                {% for error in form.password.errors %}
                  <div class="flex items-center gap-2 text-red-600">
                    <i class="ri-error-warning-line text-sm"></i>
                    <p class="text-sm font-medium">{{ error }}</p>
                  </div>
                {% endfor %}
              </div>
            {% endif %}
          </div>

          <!-- Remember Me Checkbox (Optional enhancement) -->
          <div class="flex items-center justify-between">
            <label class="flex items-center gap-3 cursor-pointer group">
              <input type="checkbox" name="remember_me" class="sr-only">
              <div class="relative">
                <div class="w-5 h-5 border-2 border-gray-300 rounded group-hover:border-purple-400 transition-colors duration-200"></div>
                <i class="ri-check-line absolute inset-0 text-white text-sm opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center justify-center"></i>
              </div>
              <span class="text-sm text-gray-600 font-medium group-hover:text-purple-600 transition-colors duration-200">Remember me</span>
            </label>
            <a href="#" class="text-sm font-medium text-purple-600 hover:text-pink-600 transition-colors duration-300 hover:underline">
              Forgot password?
            </a>
          </div>

          <!-- Enhanced Login Button -->
          <button type="submit" class="w-full group relative overflow-hidden px-8 py-4 bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 text-white rounded-2xl font-bold text-lg shadow-2xl hover:shadow-purple-500/25 transform hover:-translate-y-1 hover:scale-105 transition-all duration-300 focus:outline-none focus:ring-4 focus:ring-purple-300 disabled:opacity-50 disabled:cursor-not-allowed">
            <span class="relative z-10 flex items-center justify-center gap-3">
              <span class="login-text">Let's Go!</span>
              <i class="ri-rocket-line text-xl group-hover:animate-pulse"></i>
            </span>
            <div class="absolute inset-0 bg-gradient-to-r from-purple-700 via-pink-700 to-red-700 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
            <div class="absolute -top-2 -left-2 w-4 h-4 bg-white/30 rounded-full animate-ping opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
            <div class="absolute inset-0 bg-white/10 transform scale-x-0 group-hover:scale-x-100 origin-left transition-transform duration-500"></div>
          </button>
        </form>

        <!-- Enhanced Sign up link -->
        <div class="mt-8 text-center">
          <div class="relative">
            <div class="absolute inset-0 flex items-center">
              <div class="w-full border-t border-gradient-to-r from-transparent via-gray-300 to-transparent"></div>
            </div>
            <div class="relative flex justify-center text-sm">
              <span class="px-4 bg-white text-gray-500 font-medium">New to MockMate?</span>
            </div>
          </div>
          <div class="mt-4">
            <a href="{% url 'users:signup' %}" class="inline-flex items-center gap-2 font-bold text-purple-600 hover:text-pink-600 transition-all duration-300 group hover:scale-105">
              <span>Join the community</span>
              <i class="ri-arrow-right-line group-hover:translate-x-2 transition-transform duration-300"></i>
            </a>
          </div>
        </div>

        <!-- Social Login Options (Optional enhancement) -->
        <div class="mt-6">
          <div class="relative">
            <div class="absolute inset-0 flex items-center">
              <div class="w-full border-t border-gray-200"></div>
            </div>
            <div class="relative flex justify-center text-sm">
              <span class="px-4 bg-white text-gray-500 font-medium">Or continue with</span>
            </div>
          </div>
          <div class="mt-4 flex justify-center space-x-4">
            <button class="p-3 bg-gray-100 hover:bg-red-50 rounded-full transition-all duration-300 group hover:scale-110">
              <i class="ri-google-line text-xl text-red-500 group-hover:animate-pulse"></i>
            </button>
            <button class="p-3 bg-gray-100 hover:bg-blue-50 rounded-full transition-all duration-300 group hover:scale-110">
              <i class="ri-linkedin-line text-xl text-blue-600 group-hover:animate-pulse"></i>
            </button>
            <button class="p-3 bg-gray-100 hover:bg-gray-200 rounded-full transition-all duration-300 group hover:scale-110">
              <i class="ri-github-line text-xl text-gray-800 group-hover:animate-pulse"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- Enhanced motivational message -->
      <div class="mt-6 text-center animate-bounce-gentle">
        <div class="inline-block bg-white/10 backdrop-blur-sm rounded-full px-6 py-3 border border-white/20">
          <p class="text-white/90 font-medium text-lg">
            <span class="mr-2 animate-twinkle">âœ¨</span>
            Your dream job awaits!
            <span class="ml-2 animate-spin-slow">ðŸŽ¯</span>
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
/* Enhanced Custom animations */
@keyframes float {
  0%, 100% { 
    transform: translateY(0px) rotate(0deg); 
  }
  33% { 
    transform: translateY(-20px) rotate(120deg); 
  }
  66% { 
    transform: translateY(-10px) rotate(240deg); 
  }
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
  20%, 40%, 60%, 80% { transform: translateX(2px); }
}

@keyframes slide-in {
  from { 
    transform: translateX(-100%); 
    opacity: 0; 
  }
  to { 
    transform: translateX(0); 
    opacity: 1; 
  }
}

@keyframes fade-in {
  from { 
    opacity: 0; 
    transform: translateY(-10px); 
  }
  to { 
    opacity: 1; 
    transform: translateY(0); 
  }
}

@keyframes fade-in-up {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes bounce-slow {
  0%, 100% {
    transform: translateY(-25%);
    animation-timing-function: cubic-bezier(0.8, 0, 1, 1);
  }
  50% {
    transform: translateY(0);
    animation-timing-function: cubic-bezier(0, 0, 0.2, 1);
  }
}

@keyframes wave {
  0%, 100% { transform: rotate(0deg); }
  10%, 30%, 50%, 70%, 90% { transform: rotate(14deg); }
  20%, 40%, 60%, 80% { transform: rotate(-8deg); }
}

@keyframes pulse-slow {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.8; transform: scale(1.1); }
}

@keyframes bounce-gentle {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}

@keyframes twinkle {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(1.2); }
}

@keyframes spin-slow {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

@keyframes gradient {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

/* Animation classes */
.floating-element {
  animation: float 6s ease-in-out infinite;
}

.animation-delay-1000 { animation-delay: 1s; }
.animation-delay-2000 { animation-delay: 2s; }
.animation-delay-3000 { animation-delay: 3s; }
.animation-delay-4000 { animation-delay: 4s; }
.animation-delay-5000 { animation-delay: 5s; }

.animate-shake { animation: shake 0.5s ease-in-out; }
.animate-slide-in { animation: slide-in 0.5s ease-out; }
.animate-fade-in { animation: fade-in 0.3s ease-out; }
.animate-fade-in-up { animation: fade-in-up 0.6s ease-out; }
.animate-bounce-slow { animation: bounce-slow 2s infinite; }
.animate-wave { animation: wave 2s ease-in-out infinite; }
.animate-pulse-slow { animation: pulse-slow 2s ease-in-out infinite; }
.animate-bounce-gentle { animation: bounce-gentle 3s ease-in-out infinite; }
.animate-twinkle { animation: twinkle 1.5s ease-in-out infinite; }
.animate-spin-slow { animation: spin-slow 3s linear infinite; }
.animate-gradient { 
  background-size: 200% 200%;
  animation: gradient 3s ease infinite;
}

/* Enhanced form styling */
.form-group input:focus + i {
  color: #8b5cf6;
  transform: translateY(-50%) scale(1.1);
  transition: all 0.3s ease;
}

.form-group .group:focus-within {
  transform: scale(1.02);
}

/* Custom checkbox styling */
input[type="checkbox"]:checked + div > div {
  background: linear-gradient(135deg, #8b5cf6, #ec4899);
  border-color: #8b5cf6;
}

input[type="checkbox"]:checked + div > i {
  opacity: 1;
}

/* Loading state for button */
.login-button:disabled .login-text::after {
  content: "";
  display: inline-block;
  width: 12px;
  height: 12px;
  margin-left: 8px;
  border: 2px solid transparent;
  border-top: 2px solid #ffffff;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

/* Custom scrollbar for webkit browsers */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 10px;
}

::-webkit-scrollbar-thumb {
  background: rgba(139, 92, 246, 0.5);
  border-radius: 10px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(139, 92, 246, 0.8);
}

/* Focus states for accessibility */
button:focus-visible, 
input:focus-visible, 
a:focus-visible {
  outline: 2px solid #8b5cf6;
  outline-offset: 2px;
}

/* Responsive design */
@media (max-width: 640px) {
  .floating-element {
    display: none;
  }
  
  .max-w-md {
    max-width: 100%;
    margin: 0 1rem;
  }
}
</style>

<script>
// Password toggle functionality
function togglePassword(fieldId) {
  const passwordField = document.getElementById(fieldId);
  const toggleIcon = document.getElementById('password-toggle-icon');
  
  if (passwordField.type === 'password') {
    passwordField.type = 'text';
    toggleIcon.className = 'ri-eye-off-line text-lg';
  } else {
    passwordField.type = 'password';
    toggleIcon.className = 'ri-eye-line text-lg';
  }
}

// Form submission enhancement
document.addEventListener('DOMContentLoaded', function() {
  const form = document.querySelector('form');
  const submitButton = form.querySelector('button[type="submit"]');
  
  form.addEventListener('submit', function(e) {
    // Add loading state
    submitButton.disabled = true;
    submitButton.classList.add('login-button');
    const buttonText = submitButton.querySelector('.login-text');
    const originalText = buttonText.textContent;
    buttonText.textContent = 'Signing you in...';
    
    // Re-enable button after 3 seconds if form hasn't been submitted successfully
    setTimeout(() => {
      if (submitButton.disabled) {
        submitButton.disabled = false;
        submitButton.classList.remove('login-button');
        buttonText.textContent = originalText;
      }
    }, 3000);
  });
  
  // Enhanced focus effects
  const inputs = form.querySelectorAll('input');
  inputs.forEach(input => {
    input.addEventListener('focus', function() {
      this.parentElement.classList.add('focused');
    });
    
    input.addEventListener('blur', function() {
      this.parentElement.classList.remove('focused');
    });
  });
});

// Particle effect on successful login (optional)
function createParticles() {
  const colors = ['#8b5cf6', '#ec4899', '#ef4444', '#f59e0b'];
  for (let i = 0; i < 20; i++) {
    setTimeout(() => {
      const particle = document.createElement('div');
      particle.style.cssText = `
        position: fixed;
        width: 6px;
        height: 6px;
        background: ${colors[Math.floor(Math.random() * colors.length)]};
        border-radius: 50%;
        pointer-events: none;
        z-index: 9999;
        left: ${Math.random() * window.innerWidth}px;
        top: ${window.innerHeight}px;
        animation: particleFloat 3s ease-out forwards;
      `;
      document.body.appendChild(particle);
      
      setTimeout(() => particle.remove(), 3000);
    }, i * 100);
  }
}

// Add particle animation keyframes
const particleStyle = document.createElement('style');
particleStyle.textContent = `
  @keyframes particleFloat {
    to {
      transform: translateY(-${window.innerHeight + 100}px) rotate(720deg);
      opacity: 0;
    }
  }
`;
document.head.appendChild(particleStyle);
</script>
{% endblock %}